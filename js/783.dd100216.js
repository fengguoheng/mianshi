"use strict";(self["webpackChunkavatarvue2"]=self["webpackChunkavatarvue2"]||[]).push([[783],{4164:function(s,t,e){e.r(t),e.d(t,{default:function(){return h}});var r=function(){var s=this,t=s._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"button-group"},[t("button",{staticClass:"custom-btn",on:{click:s.jumpToTest}},[s._v("去做题")])]),t("h1",[s._v("模拟面试")]),t("div",{staticClass:"image-upload"},[t("input",{ref:"imageInput",attrs:{type:"file",accept:"image/*"}}),t("button",{attrs:{id:"submitBtn",disabled:s.isUploading},on:{click:s.handleUpload}},[s._v(" "+s._s(s.isUploading?"上传中...":"上传简历图片")+" ")])]),t("div",{directives:[{name:"show",rawName:"v-show",value:s.showProgress,expression:"showProgress"}],staticClass:"progress"},[s._v(s._s(s.progressText))]),t("div",{directives:[{name:"show",rawName:"v-show",value:s.showResult,expression:"showResult"}],staticClass:"result",domProps:{innerHTML:s._s(s.answerHtml)}})])},a=[],i=(e(4114),e(8111),e(1701),{data(){return{isUploading:!1,showProgress:!1,showResult:!1,progressText:"",answerContent:"",answerHtml:""}},methods:{async handleUpload(){const s=this.$refs.imageInput.files[0];if(s){this.isUploading=!0,this.showProgress=!0,this.progressText="正在分析简历，请稍候...";try{const t=await this.convertFileToBase64(s),e="生成10道人工智能技术岗面试选择题，题目不要针对简历内容，而是针对人工智能技术岗",r=await fetch("http://117.72.49.76:3389/image-understanding",{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"69420"},body:JSON.stringify({image_base64:t,question:e})}),a=await r.json();"processing"===a.status&&await this.pollResult(a.request_id)}catch(t){console.error("上传失败:",t),this.progressText="网络错误："+t.message}finally{this.isUploading=!1,this.showProgress=!1}}else alert("请选择图片")},async pollResult(s){try{while(1){const t=await fetch(`http://117.72.49.76:3389/get-result/${s}`),e=await t.json();if("completed"===e.status)return this.answerContent=e.content||"暂无结果",this.answerHtml=this.parseMarkdownToHtml(this.answerContent),this.showResult=!0,localStorage.setItem("question",this.answerContent),void this.jumpToTest();if("failed"===e.status)return this.answerHtml="分析失败："+(e.error||"未知错误"),void(this.showResult=!0);await new Promise((s=>setTimeout(s,3e3))),this.progressText="分析中，请稍候..."}}catch(t){console.error("轮询失败:",t),this.answerHtml="网络错误："+t.message,this.showResult=!0}},convertFileToBase64(s){return new Promise(((t,e)=>{const r=new FileReader;r.onload=s=>t(s.target.result.split(",")[1]),r.onerror=s=>e(s),r.readAsDataURL(s)}))},parseMarkdownToHtml(s){if(!s)return"";let t=s.replace(/\*\*(.*?)\*\*/g,"<h3>$1</h3>").replace(/^\s*-\s+(.*)$/gm,"<li>$1</li>").replace(/(<li>.*?<\/li>)/gs,"<ul>$1</ul>").split("\n\n").map((s=>s.trim().startsWith("<h3>")||s.trim().startsWith("<ul>")?s:`<p>${s.trim()}</p>`)).join("");return`<div class="answer-content"><h2>面试者能力评估</h2>${t}</div>`},jumpToTest(){this.$router.push("/three")}}}),o=i,n=e(1656),l=(0,n.A)(o,r,a,!1,null,"1ce9baf7",null),h=l.exports}}]);
//# sourceMappingURL=783.dd100216.js.map