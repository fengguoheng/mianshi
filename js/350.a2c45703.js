"use strict";(self["webpackChunkavatarvue2"]=self["webpackChunkavatarvue2"]||[]).push([[350],{9350:function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"nav-container"},[t("div",{staticClass:"container"},[t("div",{staticClass:"button-group"},[t("button",{staticClass:"custom-btn",on:{click:e.jumpToTest}},[e._v("笔试演练")])]),t("div",{staticClass:"image-upload"},[t("input",{ref:"imageInput",attrs:{id:"customFileInput",type:"file",accept:"image/*"},on:{change:e.previewImage}}),t("button",{attrs:{id:"submitBtn",disabled:e.isUploading},on:{click:e.handleUpload}},[e._v(" "+e._s(e.isUploading?"分析中...":"简历分析")+" ")])]),e.previewUrl?t("div",{staticClass:"image-preview"},[t("h3",{staticClass:"preview-title"},[e._v("简历图片预览")]),t("div",{staticClass:"preview-container"},[t("img",{staticClass:"preview-image",attrs:{src:e.previewUrl,alt:"上传的简历图片"}})])]):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showProgress,expression:"showProgress"}],staticClass:"progress"},[e._v(e._s(e.progressText))]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showResult,expression:"showResult"}],staticClass:"result",domProps:{innerHTML:e._s(e.answerHtml)}})])])},a=[],r=(s(4114),s(8111),s(1701),{data(){return{activeIndex:"interview",username:localStorage.getItem("username")||"用户",isUploading:!1,showProgress:!1,showResult:!1,progressText:"",answerContent:"",answerHtml:"",previewUrl:""}},methods:{handleSelect(e){this.activeIndex=e,console.log("当前选中：",e),"home"===e||"exit"===e&&localStorage.removeItem("token")},previewImage(e){const t=e.target.files[0];if(t){if(!t.type.match("image.*"))return void alert("请选择图片文件");const e=new FileReader;e.onload=e=>{this.previewUrl=e.target.result},e.readAsDataURL(t)}},async handleUpload(){const e=this.$refs.imageInput.files[0];if(e)alert("请选择图片");else{this.isUploading=!0,this.showProgress=!0,this.progressText="正在分析简历，请稍候...";try{this.$router.push("/jianlijieguo");const t=await this.convertFileToBase64(e),s="生成10道人工智能技术岗面试选择题，题目不要针对简历内容，而是针对人工智能技术岗",i=await fetch("https://117.72.49.76:443/image-understanding",{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"69420"},body:JSON.stringify({image_base64:t,question:s})}),a=await i.json();"processing"===a.status&&await this.pollResult(a.request_id)}catch(t){console.error("上传失败:",t),this.progressText="网络错误："+t.message}finally{this.isUploading=!1,this.showProgress=!1}}},async pollResult(e){try{while(1){const t=await fetch(`https://117.72.49.76:443/get-result/${e}`),s=await t.json();if("completed"===s.status)return this.answerContent=s.content||"暂无结果",this.answerHtml=this.parseMarkdownToHtml(this.answerContent),this.showResult=!0,localStorage.setItem("question",this.answerContent),void this.jumpToTest();if("failed"===s.status)return this.answerHtml="分析失败："+(s.error||"未知错误"),void(this.showResult=!0);await new Promise((e=>setTimeout(e,3e3))),this.progressText="分析中，请稍候..."}}catch(t){console.error("轮询失败:",t),this.answerHtml="网络错误："+t.message,this.showResult=!0}},convertFileToBase64(e){return new Promise(((t,s)=>{const i=new FileReader;i.onload=e=>t(e.target.result.split(",")[1]),i.onerror=e=>s(e),i.readAsDataURL(e)}))},parseMarkdownToHtml(e){if(!e)return"";let t=e.replace(/\*\*(.*?)\*\*/g,"<h3>$1</h3>").replace(/^\s*-\s+(.*)$/gm,"<li>$1</li>").replace(/(<li>.*?<\/li>)/gs,"<ul>$1</ul>").split("\n\n").map((e=>e.trim().startsWith("<h3>")||e.trim().startsWith("<ul>")?e:`<p>${e.trim()}</p>`)).join("");return`<div class="answer-content"><h2>面试者能力评估</h2>${t}</div>`},jumpToTest(){this.$router.push("/tijiaojianlishengchengwenti")}}}),o=r,n=s(1656),l=(0,n.A)(o,i,a,!1,null,"40721f56",null),h=l.exports}}]);
//# sourceMappingURL=350.a2c45703.js.map