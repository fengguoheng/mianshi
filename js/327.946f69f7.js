"use strict";(self["webpackChunkavatarvue2"]=self["webpackChunkavatarvue2"]||[]).push([[327],{7327:function(s,t,e){e.r(t),e.d(t,{default:function(){return c}});var i=function(){var s=this,t=s._self._c;return t("div",{staticClass:"container"},[t("h1",[s._v("笔试")]),s.isLoading?t("div",{staticClass:"loading"},[t("p",[s._v("正在加载题目，请稍候...")])]):t("div",{ref:"questionsContainer",staticClass:"question-container"},s._l(s.questions,(function(e,i){return t("div",{key:i,staticClass:"question"},[t("h3",[s._v("问题 "+s._s(i+1))]),t("div",{staticClass:"question-content"},[s._v(" "+s._s(e.question)+" ")]),t("div",{staticClass:"options"},s._l(e.options,(function(e,n){return t("label",{key:n,staticClass:"option"},[t("input",{directives:[{name:"model",rawName:"v-model",value:s.answers[i],expression:"answers[index]"}],attrs:{type:"radio",name:"q"+(i+1)},domProps:{value:e.value,checked:s._q(s.answers[i],e.value)},on:{change:function(t){return s.$set(s.answers,i,e.value)}}}),s._v(" "+s._s(e.label)+". "+s._s(e.content)+" ")])})),0),s.showAnswers?t("div",{staticClass:"answer"},[t("p",[t("strong",[s._v("正确答案：")]),s._v(s._s(e.answer))])]):s._e()])})),0),t("div",{staticClass:"button-area"},[t("button",{staticClass:"custom-btn",attrs:{disabled:s.isSubmitting||!s.hasAnsweredAll},on:{click:s.handleSubmit}},[s._v(" "+s._s(s.isSubmitting?"提交中...":"提交答案")+" ")]),!s.isSubmitting&&s.hasAnsweredAll?t("button",{staticClass:"show-answer-btn",on:{click:function(t){s.showAnswers=!0}}},[s._v(" 查看答案 ")]):s._e()]),t("div",{directives:[{name:"show",rawName:"v-show",value:s.isLoading,expression:"isLoading"}],staticClass:"loading"},[t("p",[s._v(s._s(s.loadingText))])]),t("div",{directives:[{name:"show",rawName:"v-show",value:s.result,expression:"result"}],staticClass:"result"},[t("p",[s._v(s._s(s.result))])])])},n=[],a=(e(4114),e(8111),e(1148),e(7588),e(1701),e(4506)),o=e.n(a),r={data(){return{rawQuestions:"",questions:[],answers:[],isLoading:!1,loadingText:"",isSubmitting:!1,result:"",showAnswers:!1}},computed:{hasAnsweredAll(){return this.answers.every((s=>s))}},mounted(){this.loadQuestions()},methods:{async loadQuestions(){this.isLoading=!0,this.loadingText="加载题目中...";try{const s=localStorage.getItem("question");if(!s)throw new Error("未找到题目数据");this.rawQuestions=s,this.parseQuestions(s),this.answers=new Array(this.questions.length).fill("")}catch(s){this.result=`错误：${s.message}，请先上传简历生成题目。`}finally{this.isLoading=!1}},parseQuestions(s){const t=[],e=s.split("\n");let i=null,n=[],a=!1;e.forEach(((s,e)=>{const o=s.trim();if(o.startsWith("答案：")||o.startsWith("答案:"))return void(a=!0);if(a)return;const r=o.match(/^Q(\d+):$/);if(r){parseInt(r[1],10);i&&(i.options=n,t.push(i),n=[]),i={question:"",options:[],answer:""}}else if(o.startsWith("A.")||o.startsWith("B.")||o.startsWith("C.")||o.startsWith("D.")){const s=o.charAt(0),t=o.slice(2).trim();n.push({label:s,content:t,value:s})}else i&&o&&(i.question+=o+"\n")})),i&&(i.options=n,t.push(i)),this.parseAnswers(s),this.questions=t},parseAnswers(s){const t=s.match(/答案：(.*)/);if(t&&t[1]){const s=t[1].split("，");s.forEach((s=>{const[t,e]=s.split(": ");if(t&&e){const s=parseInt(t.replace("Q",""),10);s>0&&s<=this.questions.length&&(this.questions[s-1].answer=e)}}))}},async handleSubmit(){if(this.hasAnsweredAll){this.isSubmitting=!0,this.loadingText="正在提交答案...",this.result="";try{const s=await o()(this.$refs.questionsContainer,{useCORS:!0,logging:!1}),t=s.toDataURL("image/png").split(",")[1],e=this.answers.map(((s,t)=>`Q${t+1}: ${s}`)).join("\n"),i=`分析面试者答案：\n${e}`,n=await fetch("https://117.72.49.76:443/image-understanding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image_base64:t,question:i})}),a=await n.json();"processing"===a.status?await this.pollResult(a.request_id):this.result=`处理失败：${a.error||"未知错误"}`}catch(s){this.result=`请求失败：${s.message}`}finally{this.isSubmitting=!1}}else alert("请回答所有问题")},async pollResult(s){try{while(1){const t=await fetch(`https://117.72.49.76:443/get-result/${s}`),e=await t.json();if("completed"===e.status)return localStorage.setItem("answer",e.content),void this.$router.push({name:"bishileidatu"});if("processing"!==e.status)return void(this.result=`处理失败：${e.error||"未知错误"}`);await new Promise((s=>setTimeout(s,3e3))),this.loadingText="分析中，请稍候..."}}catch(t){this.result=`轮询失败：${t.message}`}}}},l=r,u=e(1656),h=(0,u.A)(l,i,n,!1,null,null,null),c=h.exports}}]);
//# sourceMappingURL=327.946f69f7.js.map