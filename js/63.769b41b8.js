"use strict";(self["webpackChunkavatarvue2"]=self["webpackChunkavatarvue2"]||[]).push([[63],{3063:function(s,t,e){e.r(t),e.d(t,{default:function(){return h}});var i=function(){var s=this,t=s._self._c;return t("div",{staticClass:"container"},[t("h1",[s._v("笔试")]),s.isLoading?t("div",{staticClass:"loading"},[t("p",[s._v("正在加载题目，请稍候...")])]):t("div",{ref:"questionsContainer",staticClass:"question-container"},s._l(s.parsedQuestions,(function(e,i){return t("div",{key:i,staticClass:"question"},[t("h3",[s._v("问题 "+s._s(i+1))]),t("pre",{staticStyle:{"white-space":"pre-wrap","word-break":"break-all",background:"#f8f9fa",padding:"15px","border-radius":"8px"}},[s._v("        "+s._s(e)+"\n      ")]),t("div",{staticClass:"options"},s._l(["A","B","C","D"],(function(e){return t("label",{key:e,staticClass:"option"},[t("input",{directives:[{name:"model",rawName:"v-model",value:s.answers[i],expression:"answers[index]"}],attrs:{type:"radio",name:"q"+(i+1)},domProps:{value:e,checked:s._q(s.answers[i],e)},on:{change:function(t){return s.$set(s.answers,i,e)}}}),s._v(" "+s._s(e)+" ")])})),0)])})),0),t("button",{staticClass:"custom-btn",attrs:{disabled:s.isSubmitting||!s.hasAnsweredAll},on:{click:s.handleSubmit}},[s._v(" "+s._s(s.isSubmitting?"提交中...":"提交")+" ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:s.isLoading,expression:"isLoading"}],staticClass:"loading"},[t("p",[s._v(s._s(s.loadingText))])]),t("div",{directives:[{name:"show",rawName:"v-show",value:s.result,expression:"result"}],staticClass:"result"},[t("p",[s._v(s._s(s.result))])])])},a=[],n=(e(4114),e(8111),e(1148),e(2489),e(1701),e(4506)),r=e.n(n),o={data(){return{rawQuestions:"",parsedQuestions:[],answers:[],isLoading:!1,loadingText:"",isSubmitting:!1,result:""}},computed:{hasAnsweredAll(){return this.answers.every((s=>s))}},mounted(){this.loadQuestions()},methods:{async loadQuestions(){this.isLoading=!0,this.loadingText="加载题目中...";try{const s=localStorage.getItem("question");if(!s)throw new Error("未找到题目数据");this.rawQuestions=s,this.parsedQuestions=s.split("\n\n").filter((s=>s.trim())),this.answers=new Array(this.parsedQuestions.length).fill("")}catch(s){this.result=`错误：${s.message}，请先上传简历生成题目。`}finally{this.isLoading=!1}},async handleSubmit(){if(this.hasAnsweredAll){this.isSubmitting=!0,this.loadingText="正在提交答案...",this.result="";try{const s=await r()(this.$refs.questionsContainer,{useCORS:!0,logging:!1}),t=s.toDataURL("image/png").split(",")[1],e=this.answers.map(((s,t)=>`Q${t+1}: ${s}`)).join("\n"),i=`分析面试者答案：\n${e}`,a=await fetch("https://117.72.49.76:443/image-understanding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image_base64:t,question:i})}),n=await a.json();"processing"===n.status?await this.pollResult(n.request_id):this.result=`处理失败：${n.error||"未知错误"}`}catch(s){this.result=`请求失败：${s.message}`}finally{this.isSubmitting=!1}}else alert("请回答所有问题")},async pollResult(s){try{while(1){const t=await fetch(`https://117.72.49.76:443/get-result/${s}`),e=await t.json();if("completed"===e.status)return localStorage.setItem("answer",e.content),void this.$router.push({name:"bishileidatu"});if("processing"!==e.status)return void(this.result=`处理失败：${e.error||"未知错误"}`);await new Promise((s=>setTimeout(s,3e3))),this.loadingText="分析中，请稍候..."}}catch(t){this.result=`轮询失败：${t.message}`}}}},l=o,u=e(1656),d=(0,u.A)(l,i,a,!1,null,null,null),h=d.exports}}]);
//# sourceMappingURL=63.769b41b8.js.map